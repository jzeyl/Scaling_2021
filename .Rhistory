#inset_element(p = earimg,
#              left = 0.8,
#              bottom = 0.1,
#              right = 1,
#              top = 0.2)
}
runplot_HM_only(3)
runplot_HM_only(3)
runplot_HM_only<-function(e){
slopeline<-pgls_models_list1[e][[1]]$model$coef[1]+
log(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e])$Head.mass..g.)*
(pgls_models_list1[e][[1]]$model$coef[2])
isoline<-pgls_models_list1[e][[1]]$model$coef[1]+
log(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e])$Head.mass..g.)*
geomcoefs[e]
pval<-summary(pgls_models_list1[[e]])$coefficients[,4][[2]]
lbl<-data.frame(
xpos = c(-Inf,-Inf),
ypos = c(-Inf,-Inf),
annotateText = c(" ",paste('R^2 == ',signif(summary(pgls_models_list1[[e]])$r.squared,2))),
hjust = c(-0.1,-0.5),
vjust = c(-0.5,-0.5)
)
rsq_label <- paste(' R^2 == ', '3')
ggplot(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.), y = log(earmeasureval), label = Binomial),
factor = as.factor(waterbirds))+
theme_classic()+
theme(legend.position = "none",
#axis.text.x = element_blank(),
axis.title.x = element_blank())+{
if(hm$scalingtype[e*2] == "isometric")
geom_point(aes(shape = waterbirds), size = 2, col = "grey")
else if(hm$scalingtype[e*2] == "hypoallometric")
geom_point(aes(shape = waterbirds), size = 2, col = "blue")
else  if(hm$scalingtype[e*2] == "hyperallometric")
geom_point(aes(shape = waterbirds), size = 2, col = "red")
}  +
scale_color_manual(values=c("green","blue","darkgrey","l2ghtblue","green","darkgray","darkgreen","corns2lk4","blue"))+
geom_line(data = subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.),y = slopeline), col = "black", size = 2)+
geom_line(data = subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.),y = isoline), col = "grey", size = 2)+
ylab(paste0("log(",codes[e],")"))+
#geom_text(data = lbl,aes(x = xpos, y = ypos, label = annotateText,
#                         hjust = hjust, vjust = vjust, paste = TRUE))+
annotate(geom = 'text', x = -Inf, y = Inf, label = paste('R^2 == ',signif(summary(pgls_models_list1[[e]])$r.squared,2)), hjust = c(-0.5), vjust = 1, parse = TRUE)+
ggtitle(categorylist[e])#+
#inset_element(p = earimg,
#              left = 0.8,
#              bottom = 0.1,
#              right = 1,
#              top = 0.2)
}
runplot_HM_only(3)
runplot_HM_only(1)+
runplot_HM_only(2)+
runplot_HM_only(3)+
runplot_HM_only(4)+
runplot_HM_only(5)+
runplot_HM_only(6)+
runplot_HM_only(7)+
runplot_HM_only(8)+
runplot_HM_only(9)+
runplot_HM_only(10)+
runplot_HM_only(11)+
runplot_HM_only(12)+
runplot_HM_only(13) +plot_annotation(tag_levels = "A")
runplot_HM_only<-function(e){
slopeline<-pgls_models_list1[e][[1]]$model$coef[1]+
log(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e])$Head.mass..g.)*
(pgls_models_list1[e][[1]]$model$coef[2])
isoline<-pgls_models_list1[e][[1]]$model$coef[1]+
log(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e])$Head.mass..g.)*
geomcoefs[e]
pval<-summary(pgls_models_list1[[e]])$coefficients[,4][[2]]
lbl<-data.frame(
xpos = c(-Inf,-Inf),
ypos = c(-Inf,-Inf),
annotateText = c(" ",paste('R^2 == ',signif(summary(pgls_models_list1[[e]])$r.squared,2))),
hjust = c(-0.1,-0.5),
vjust = c(-0.5,-0.5)
)
rsq_label <- paste(' R^2 == ', '3')
ggplot(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.), y = log(earmeasureval), label = Binomial),
factor = as.factor(waterbirds))+
theme_classic()+
theme(legend.position = "none",
#axis.text.x = element_blank(),
axis.title.x = element_blank())+{
if(hm$scalingtype[e*2] == "isometric")
geom_point(aes(), size = 2, col = "grey")
else if(hm$scalingtype[e*2] == "hypoallometric")
geom_point(aes(shape = waterbirds), size = 2, col = "blue")
else  if(hm$scalingtype[e*2] == "hyperallometric")
geom_point(aes(shape = waterbirds), size = 2, col = "red")
}  +
scale_color_manual(values=c("green","blue","darkgrey","l2ghtblue","green","darkgray","darkgreen","corns2lk4","blue"))+
geom_line(data = subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.),y = slopeline), col = "black", size = 2)+
geom_line(data = subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.),y = isoline), col = "grey", size = 2)+
ylab(paste0("log(",codes[e],")"))+
#geom_text(data = lbl,aes(x = xpos, y = ypos, label = annotateText,
#                         hjust = hjust, vjust = vjust, paste = TRUE))+
annotate(geom = 'text', x = -Inf, y = Inf, label = paste('R^2 == ',signif(summary(pgls_models_list1[[e]])$r.squared,2)), hjust = c(-0.5), vjust = 1, parse = TRUE)+
ggtitle(categorylist[e])#+
#inset_element(p = earimg,
#              left = 0.8,
#              bottom = 0.1,
#              right = 1,
#              top = 0.2)
}
runplot_HM_only(3)
runplot_HM_only<-function(e){
slopeline<-pgls_models_list1[e][[1]]$model$coef[1]+
log(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e])$Head.mass..g.)*
(pgls_models_list1[e][[1]]$model$coef[2])
isoline<-pgls_models_list1[e][[1]]$model$coef[1]+
log(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e])$Head.mass..g.)*
geomcoefs[e]
pval<-summary(pgls_models_list1[[e]])$coefficients[,4][[2]]
lbl<-data.frame(
xpos = c(-Inf,-Inf),
ypos = c(-Inf,-Inf),
annotateText = c(" ",paste('R^2 == ',signif(summary(pgls_models_list1[[e]])$r.squared,2))),
hjust = c(-0.1,-0.5),
vjust = c(-0.5,-0.5)
)
rsq_label <- paste(' R^2 == ', '3')
ggplot(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.), y = log(earmeasureval), label = Binomial),
factor = as.factor(waterbirds))+
theme_classic()+
theme(legend.position = "none",
#axis.text.x = element_blank(),
axis.title.x = element_blank())+{
if(hm$scalingtype[e*2] == "isometric")
geom_point(aes(), size = 2, col = "grey")
else if(hm$scalingtype[e*2] == "hypoallometric")
geom_point(aes(), size = 2, col = "blue")
else  if(hm$scalingtype[e*2] == "hyperallometric")
geom_point(aes(), size = 2, col = "red")
}  +
scale_color_manual(values=c("green","blue","darkgrey","l2ghtblue","green","darkgray","darkgreen","corns2lk4","blue"))+
geom_line(data = subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.),y = slopeline), col = "black", size = 2)+
geom_line(data = subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.),y = isoline), col = "grey", size = 2)+
ylab(paste0("log(",codes[e],")"))+
#geom_text(data = lbl,aes(x = xpos, y = ypos, label = annotateText,
#                         hjust = hjust, vjust = vjust, paste = TRUE))+
annotate(geom = 'text', x = -Inf, y = Inf, label = paste('R^2 == ',signif(summary(pgls_models_list1[[e]])$r.squared,2)), hjust = c(-0.5), vjust = 1, parse = TRUE)+
ggtitle(categorylist[e])#+
#inset_element(p = earimg,
#              left = 0.8,
#              bottom = 0.1,
#              right = 1,
#              top = 0.2)
}
runplot_HM_only(3)
runplot_HM_only(1)+
runplot_HM_only(2)+
runplot_HM_only(3)+
runplot_HM_only(4)+
runplot_HM_only(5)+
runplot_HM_only(6)+
runplot_HM_only(7)+
runplot_HM_only(8)+
runplot_HM_only(9)+
runplot_HM_only(10)+
runplot_HM_only(11)+
runplot_HM_only(12)+
runplot_HM_only(13) +plot_annotation(tag_levels = "A")
runplot_HM_only(3)
runplot_HM_only<-function(e){
slopeline<-pgls_models_list1[e][[1]]$model$coef[1]+
log(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e])$Head.mass..g.)*
(pgls_models_list1[e][[1]]$model$coef[2])
isoline<-pgls_models_list1[e][[1]]$model$coef[1]+
log(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e])$Head.mass..g.)*
geomcoefs[e]
pval<-summary(pgls_models_list1[[e]])$coefficients[,4][[2]]
lbl<-data.frame(
xpos = c(-Inf,-Inf),
ypos = c(-Inf,-Inf),
annotateText = c(" ",paste('R^2 == ',signif(summary(pgls_models_list1[[e]])$r.squared,2))),
hjust = c(-0.1,-0.5),
vjust = c(-0.5,-0.5)
)
rsq_label <- paste(' R^2 == ', '3')
ggplot(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.), y = log(earmeasureval), label = Binomial),
factor = as.factor(waterbirds))+
theme_classic()+
theme(legend.position = "none",
#axis.text.x = element_blank(),
axis.title.x = element_blank())+{
if(hm$scalingtype[e*2] == "isometric")
geom_point(aes(), size = 2, col = "grey")
else if(hm$scalingtype[e*2] == "hypoallometric")
geom_point(aes(), size = 2, col = "blue")
else  if(hm$scalingtype[e*2] == "hyperallometric")
geom_point(aes(), size = 2, col = "red")
}  +
scale_color_manual(values=c("green","blue","darkgrey","l2ghtblue","green","darkgray","darkgreen","corns2lk4","blue"))+
geom_line(data = subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.),y = slopeline), col = "black", size = 2)+
geom_line(data = subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.),y = isoline), col = "grey", size = 2)+
ylab(paste0("log(",codes[e],")"))+
#geom_text(data = lbl,aes(x = xpos, y = ypos, label = annotateText,
#                         hjust = hjust, vjust = vjust, paste = TRUE))+
annotate(geom = 'text', x = Inf, y = -Inf, label = paste('R^2 == ',signif(summary(pgls_models_list1[[e]])$r.squared,2)), hjust = c(-0.5), vjust = 1, parse = TRUE)+
ggtitle(categorylist[e])#+
#inset_element(p = earimg,
#              left = 0.8,
#              bottom = 0.1,
#              right = 1,
#              top = 0.2)
}
runplot_HM_only(3)
runplot_HM_only<-function(e){
slopeline<-pgls_models_list1[e][[1]]$model$coef[1]+
log(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e])$Head.mass..g.)*
(pgls_models_list1[e][[1]]$model$coef[2])
isoline<-pgls_models_list1[e][[1]]$model$coef[1]+
log(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e])$Head.mass..g.)*
geomcoefs[e]
pval<-summary(pgls_models_list1[[e]])$coefficients[,4][[2]]
lbl<-data.frame(
xpos = c(-Inf,-Inf),
ypos = c(-Inf,-Inf),
annotateText = c(" ",paste('R^2 == ',signif(summary(pgls_models_list1[[e]])$r.squared,2))),
hjust = c(-0.1,-0.5),
vjust = c(-0.5,-0.5)
)
rsq_label <- paste(' R^2 == ', '3')
ggplot(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.), y = log(earmeasureval), label = Binomial),
factor = as.factor(waterbirds))+
theme_classic()+
theme(legend.position = "none",
#axis.text.x = element_blank(),
axis.title.x = element_blank())+{
if(hm$scalingtype[e*2] == "isometric")
geom_point(aes(), size = 2, col = "grey")
else if(hm$scalingtype[e*2] == "hypoallometric")
geom_point(aes(), size = 2, col = "blue")
else  if(hm$scalingtype[e*2] == "hyperallometric")
geom_point(aes(), size = 2, col = "red")
}  +
scale_color_manual(values=c("green","blue","darkgrey","l2ghtblue","green","darkgray","darkgreen","corns2lk4","blue"))+
geom_line(data = subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.),y = slopeline), col = "black", size = 2)+
geom_line(data = subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.),y = isoline), col = "grey", size = 2)+
ylab(paste0("log(",codes[e],")"))+
#geom_text(data = lbl,aes(x = xpos, y = ypos, label = annotateText,
#                         hjust = hjust, vjust = vjust, paste = TRUE))+
annotate(geom = 'text', x = Inf, y = -Inf, label = paste('R^2 == ',signif(summary(pgls_models_list1[[e]])$r.squared,2)), hjust = c(0), vjust = 0, parse = TRUE)+
ggtitle(categorylist[e])#+
#inset_element(p = earimg,
#              left = 0.8,
#              bottom = 0.1,
#              right = 1,
#              top = 0.2)
}
runplot_HM_only(3)
runplot_HM_only<-function(e){
slopeline<-pgls_models_list1[e][[1]]$model$coef[1]+
log(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e])$Head.mass..g.)*
(pgls_models_list1[e][[1]]$model$coef[2])
isoline<-pgls_models_list1[e][[1]]$model$coef[1]+
log(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e])$Head.mass..g.)*
geomcoefs[e]
pval<-summary(pgls_models_list1[[e]])$coefficients[,4][[2]]
lbl<-data.frame(
xpos = c(-Inf,-Inf),
ypos = c(-Inf,-Inf),
annotateText = c(" ",paste('R^2 == ',signif(summary(pgls_models_list1[[e]])$r.squared,2))),
hjust = c(-0.1,-0.5),
vjust = c(-0.5,-0.5)
)
rsq_label <- paste(' R^2 == ', '3')
ggplot(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.), y = log(earmeasureval), label = Binomial),
factor = as.factor(waterbirds))+
theme_classic()+
theme(legend.position = "none",
#axis.text.x = element_blank(),
axis.title.x = element_blank())+{
if(hm$scalingtype[e*2] == "isometric")
geom_point(aes(), size = 2, col = "grey")
else if(hm$scalingtype[e*2] == "hypoallometric")
geom_point(aes(), size = 2, col = "blue")
else  if(hm$scalingtype[e*2] == "hyperallometric")
geom_point(aes(), size = 2, col = "red")
}  +
scale_color_manual(values=c("green","blue","darkgrey","l2ghtblue","green","darkgray","darkgreen","corns2lk4","blue"))+
geom_line(data = subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.),y = slopeline), col = "black", size = 2)+
geom_line(data = subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.),y = isoline), col = "grey", size = 2)+
ylab(paste0("log(",codes[e],")"))+
#geom_text(data = lbl,aes(x = xpos, y = ypos, label = annotateText,
#                         hjust = hjust, vjust = vjust, paste = TRUE))+
annotate(geom = 'text', x = Inf, y = -Inf, label = paste('R^2 == ',signif(summary(pgls_models_list1[[e]])$r.squared,2)), hjust = "inward", vjust = 0, parse = TRUE)+
ggtitle(categorylist[e])#+
#inset_element(p = earimg,
#              left = 0.8,
#              bottom = 0.1,
#              right = 1,
#              top = 0.2)
}
runplot_HM_only(3)
runplot_HM_only<-function(e){
slopeline<-pgls_models_list1[e][[1]]$model$coef[1]+
log(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e])$Head.mass..g.)*
(pgls_models_list1[e][[1]]$model$coef[2])
isoline<-pgls_models_list1[e][[1]]$model$coef[1]+
log(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e])$Head.mass..g.)*
geomcoefs[e]
pval<-summary(pgls_models_list1[[e]])$coefficients[,4][[2]]
lbl<-data.frame(
xpos = c(-Inf,-Inf),
ypos = c(-Inf,-Inf),
annotateText = c(" ",paste('R^2 == ',signif(summary(pgls_models_list1[[e]])$r.squared,2))),
hjust = c(-0.1,-0.5),
vjust = c(-0.5,-0.5)
)
rsq_label <- paste(' R^2 == ', '3')
ggplot(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.), y = log(earmeasureval), label = Binomial),
factor = as.factor(waterbirds))+
theme_classic()+
theme(legend.position = "none",
#axis.text.x = element_blank(),
axis.title.x = element_blank())+{
if(hm$scalingtype[e*2] == "isometric")
geom_point(aes(), size = 2, col = "grey")
else if(hm$scalingtype[e*2] == "hypoallometric")
geom_point(aes(), size = 2, col = "blue")
else  if(hm$scalingtype[e*2] == "hyperallometric")
geom_point(aes(), size = 2, col = "red")
}  +
scale_color_manual(values=c("green","blue","darkgrey","l2ghtblue","green","darkgray","darkgreen","corns2lk4","blue"))+
geom_line(data = subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.),y = slopeline), col = "black", size = 2)+
geom_line(data = subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.),y = isoline), col = "grey", size = 2)+
ylab(paste0("log(",codes[e],")"))+
#geom_text(data = lbl,aes(x = xpos, y = ypos, label = annotateText,
#                         hjust = hjust, vjust = vjust, paste = TRUE))+
annotate(geom = 'text', x = Inf, y = -Inf, label = paste('R^2 == ',signif(summary(pgls_models_list1[[e]])$r.squared,2)), hjust = "inward", vjust = 0.1, parse = TRUE)+
ggtitle(categorylist[e])#+
}
runplot_HM_only(3)
runplot_HM_only<-function(e){
slopeline<-pgls_models_list1[e][[1]]$model$coef[1]+
log(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e])$Head.mass..g.)*
(pgls_models_list1[e][[1]]$model$coef[2])
isoline<-pgls_models_list1[e][[1]]$model$coef[1]+
log(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e])$Head.mass..g.)*
geomcoefs[e]
pval<-summary(pgls_models_list1[[e]])$coefficients[,4][[2]]
lbl<-data.frame(
xpos = c(-Inf,-Inf),
ypos = c(-Inf,-Inf),
annotateText = c(" ",paste('R^2 == ',signif(summary(pgls_models_list1[[e]])$r.squared,2))),
hjust = c(-0.1,-0.5),
vjust = c(-0.5,-0.5)
)
rsq_label <- paste(' R^2 == ', '3')
ggplot(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.), y = log(earmeasureval), label = Binomial),
factor = as.factor(waterbirds))+
theme_classic()+
theme(legend.position = "none",
#axis.text.x = element_blank(),
axis.title.x = element_blank())+{
if(hm$scalingtype[e*2] == "isometric")
geom_point(aes(), size = 2, col = "grey")
else if(hm$scalingtype[e*2] == "hypoallometric")
geom_point(aes(), size = 2, col = "blue")
else  if(hm$scalingtype[e*2] == "hyperallometric")
geom_point(aes(), size = 2, col = "red")
}  +
scale_color_manual(values=c("green","blue","darkgrey","l2ghtblue","green","darkgray","darkgreen","corns2lk4","blue"))+
geom_line(data = subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.),y = slopeline), col = "black", size = 2)+
geom_line(data = subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.),y = isoline), col = "grey", size = 2)+
ylab(paste0("log(",codes[e],")"))+
#geom_text(data = lbl,aes(x = xpos, y = ypos, label = annotateText,
#                         hjust = hjust, vjust = vjust, paste = TRUE))+
annotate(geom = 'text', x = Inf, y = -Inf, label = paste('R^2 == ',signif(summary(pgls_models_list1[[e]])$r.squared,2)), hjust = "inward", vjust = "inward", parse = TRUE)+
ggtitle(categorylist[e])#+
}
runplot_HM_only(3)
runplot_HM_only(1)+
runplot_HM_only(2)+
runplot_HM_only(3)+
runplot_HM_only(4)+
runplot_HM_only(5)+
runplot_HM_only(6)+
runplot_HM_only(7)+
runplot_HM_only(8)+
runplot_HM_only(9)+
runplot_HM_only(10)+
runplot_HM_only(11)+
runplot_HM_only(12)+
runplot_HM_only(13) +plot_annotation(tag_levels = "A")
runplot_HM_only<-function(e){
slopeline<-pgls_models_list1[e][[1]]$model$coef[1]+
log(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e])$Head.mass..g.)*
(pgls_models_list1[e][[1]]$model$coef[2])
isoline<-pgls_models_list1[e][[1]]$model$coef[1]+
log(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e])$Head.mass..g.)*
geomcoefs[e]
pval<-summary(pgls_models_list1[[e]])$coefficients[,4][[2]]
lbl<-data.frame(
xpos = c(-Inf,-Inf),
ypos = c(-Inf,-Inf),
annotateText = c(" ",paste('R^2 == ',signif(summary(pgls_models_list1[[e]])$r.squared,2))),
hjust = c(-0.1,-0.5),
vjust = c(-0.5,-0.5)
)
rsq_label <- paste(' R^2 == ', '3')
ggplot(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.), y = log(earmeasureval), label = Binomial),
factor = as.factor(waterbirds))+
theme_classic()+
theme(legend.position = "none",
#axis.text.x = element_blank(),
axis.title.x = element_blank())+{
if(hm$scalingtype[e*2] == "isometric")
geom_point(aes(), size = 2, col = "grey")
else if(hm$scalingtype[e*2] == "hypoallometric")
geom_point(aes(), size = 2, col = "blue")
else  if(hm$scalingtype[e*2] == "hyperallometric")
geom_point(aes(), size = 2, col = "red")
}  +
scale_color_manual(values=c("green","blue","darkgrey","l2ghtblue","green","darkgray","darkgreen","corns2lk4","blue"))+
geom_line(data = subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.),y = slopeline), col = "black", size = 2)+
geom_line(data = subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.),y = isoline), col = "grey", size = 2)+
ylab(paste0("log(",codes[e],")"))+
#geom_text(data = lbl,aes(x = xpos, y = ypos, label = annotateText,
#                         hjust = hjust, vjust = vjust, paste = TRUE))+
annotate(geom = 'text', x = Inf, y = -Inf, label = paste('R^2 == ',signif(summary(pgls_models_list1[[e]])$r.squared,2)), hjust = "inward", vjust = 0.5, parse = TRUE)+
ggtitle(categorylist[e])#+
}
runplot_HM_only(3)
#input geomcoff
runplot_HM_only<-function(e){
slopeline<-pgls_models_list1[e][[1]]$model$coef[1]+
log(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e])$Head.mass..g.)*
(pgls_models_list1[e][[1]]$model$coef[2])
isoline<-pgls_models_list1[e][[1]]$model$coef[1]+
log(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e])$Head.mass..g.)*
geomcoefs[e]
pval<-summary(pgls_models_list1[[e]])$coefficients[,4][[2]]
lbl<-data.frame(
xpos = c(-Inf,-Inf),
ypos = c(-Inf,-Inf),
annotateText = c(" ",paste('R^2 == ',signif(summary(pgls_models_list1[[e]])$r.squared,2))),
hjust = c(-0.1,-0.5),
vjust = c(-0.5,-0.5)
)
rsq_label <- paste(' R^2 == ', '3')
ggplot(subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.), y = log(earmeasureval), label = Binomial),
factor = as.factor(waterbirds))+
theme_classic()+
theme(legend.position = "none",
#axis.text.x = element_blank(),
axis.title.x = element_blank())+{
if(hm$scalingtype[e*2] == "isometric")
geom_point(aes(), size = 2, col = "grey")
else if(hm$scalingtype[e*2] == "hypoallometric")
geom_point(aes(), size = 2, col = "blue")
else  if(hm$scalingtype[e*2] == "hyperallometric")
geom_point(aes(), size = 2, col = "red")
}  +
scale_color_manual(values=c("green","blue","darkgrey","l2ghtblue","green","darkgray","darkgreen","corns2lk4","blue"))+
geom_line(data = subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.),y = slopeline), col = "black", size = 2)+
geom_line(data = subset(longdfplotting,longdfplotting$earmeasures==yvarnames[e]),
aes(x = log(Head.mass..g.),y = isoline), col = "grey", size = 2)+
ylab(paste0("log(",codes[e],")"))+
#geom_text(data = lbl,aes(x = xpos, y = ypos, label = annotateText,
#                         hjust = hjust, vjust = vjust, paste = TRUE))+
annotate(geom = 'text', x = Inf, y = -Inf, label = paste('R^2 == ',signif(summary(pgls_models_list1[[e]])$r.squared,2)), hjust = "inward", vjust = -0.5, parse = TRUE)+
ggtitle(categorylist[e])#+
}
runplot_HM_only(3)
runplot_HM_only(1)+
runplot_HM_only(2)+
runplot_HM_only(3)+
runplot_HM_only(4)+
runplot_HM_only(5)+
runplot_HM_only(6)+
runplot_HM_only(7)+
runplot_HM_only(8)+
runplot_HM_only(9)+
runplot_HM_only(10)+
runplot_HM_only(11)+
runplot_HM_only(12)+
runplot_HM_only(13) +plot_annotation(tag_levels = "A")
